<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<!-- This is a simple gadget, as described in
     http://code.google.com/apis/gadgets/docs/dev_guide.html

     The URL of this spec is
     http://oauth.googlecode.com/svn/code/javascript/example/gadget/spec.xml
     as usual for files in this Subversion repository.
 -->
  <ModulePrefs title="OAuth javascript/example/gadget"/>
  <Content type="html">
<![CDATA[
    <script src="http://oauth.googlecode.com/svn/code/javascript/oauthTest.js"></script>
    <script src="http://oauth.googlecode.com/svn/code/javascript/oauth.js"></script>
    <script src="http://oauth.googlecode.com/svn/code/javascript/sha1.js"></script>
    <script src="http://oauth.googlecode.com/svn/code/javascript/example/consumer.js"></script>
    <button onclick="getSpec()">Get Spec</button><br/>
    <button onclick="testOAuth()">Test Library</button><br/>
    <button onclick="getRequestToken(consumer.termie)">Get Request Token</button><br/>
    <script>
function showBody(response) {
    alert(response.text); // The HTTP response body
};
function getSpec() {
    var url = "http://oauth.googlecode.com/svn/code/javascript/example/gadget/spec.xml";
    var params = {};
    params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.TEXT;
    gadgets.io.makeRequest(url, showBody, params);
};
function getRequestToken(c) {
    var URL = c.serviceProvider.requestTokenURL;
    var accessor= { consumerSecret: c.consumerSecret
                  , tokenSecret   : ''
                  };
    var message = { method: 'POST'
                  , action: URL
                  , parameters: { oauth_consumer_key: c.consumerKey
                                , oauth_signature_method: c.serviceProvider.signatureMethod
                                }
                  };
    OAuth.setTimestampAndNonce(message);
    OAuth.SignatureMethod.sign(message, accessor);
    var params = {};
    params[gadgets.io.RequestParameters.METHOD] = gadgets.io.MethodType.POST;
    params[gadgets.io.RequestParameters.HEADERS] = {'Content-Type': 'application/x-www-form-urlencoded'};
    params[gadgets.io.RequestParameters.POST_DATA] = OAuth.formEncode(message.parameters);
    params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.TEXT;
    gadgets.io.makeRequest(URL, showBody, params);
};
    </script>
]]>
  </Content>
</Module>
